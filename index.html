<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>God's Plan | Portal Corporativo</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fuentes e Iconos -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] },
                    colors: {
                        brand: '#E70000', 
                        brandDark: '#8a0000',
                        dark: '#050505',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #000; 
            color: white; 
            overflow-x: hidden;
        } 

        /* Scrollbar Personalizado */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #E70000; }

        /* Fondo Grid Tecnológico */
        .bg-tech {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at 10% 10%, #150000 0%, #000 80%);
        }
        .grid-overlay {
            position: absolute; inset: 0;
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
            pointer-events: none;
        }

        /* Glass Cards */
        .glass-panel {
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Sticky Login Container */
        .sticky-container {
            position: sticky;
            top: 100px; /* Espacio desde arriba */
            height: fit-content;
        }

        /* Animaciones de Scroll */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease-out;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Inputs */
        .input-modern {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
            transition: all 0.3s;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
        }
        .input-modern:focus {
            border-color: #E70000;
            background: rgba(231,0,0,0.05);
            outline: none;
            box-shadow: 0 0 0 2px rgba(231,0,0,0.1);
        }
    </style>
</head>
<body class="antialiased">

    <div class="bg-tech">
        <div class="grid-overlay"></div>
    </div>

    <!-- HEADER -->
    <header class="h-20 border-b border-white/5 backdrop-blur-md fixed top-0 w-full z-50 flex items-center justify-between px-6 lg:px-12 bg-black/50">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded bg-brand flex items-center justify-center text-white shadow-lg shadow-brand/20">
                <i class="ph-bold ph-circles-three-plus text-xl"></i>
            </div>
            <span class="font-bold tracking-widest text-sm md:text-base">GOD'S PLAN</span>
        </div>
        
        <!-- User Status (Visible on Header) -->
        <div id="user-display-mini" class="hidden flex items-center gap-3">
            <span id="header-user-name" class="text-xs font-mono text-zinc-400 hidden sm:block">Usuario</span>
            <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
            <button id="logout-button-mini" class="text-zinc-500 hover:text-white transition-colors" title="Salir">
                <i class="ph-bold ph-sign-out text-lg"></i>
            </button>
        </div>
    </header>

    <!-- MAIN LAYOUT -->
    <main class="relative w-full max-w-7xl mx-auto px-6 grid lg:grid-cols-12 gap-12 pt-32 pb-20">
        
        <!-- COLUMNA IZQUIERDA (SCROLLABLE CONTENT) -->
        <div class="lg:col-span-7 flex flex-col gap-32">
            
            <!-- SECCIÓN 1: HERO -->
            <section class="reveal active relative pt-10">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-brand/30 bg-brand/5 text-brand text-[10px] font-bold tracking-widest mb-6">
                    <span class="w-1.5 h-1.5 rounded-full bg-brand animate-ping"></span>
                    SISTEMA ACTIVO v2.5
                </div>
                <h1 class="text-6xl md:text-8xl font-black tracking-tighter text-white mb-6 leading-[0.9]">
                    CORPO<br><span class="text-transparent bg-clip-text bg-gradient-to-r from-brand to-red-600">DATOS</span>
                </h1>
                <p class="text-zinc-400 text-lg md:text-xl max-w-lg leading-relaxed border-l-4 border-brand/50 pl-6">
                    La central de inteligencia definitiva. Controla adherencia, finanzas y comunicaciones en una interfaz unificada.
                </p>
                
                <!-- Métricas Hero -->
                <div class="grid grid-cols-2 gap-8 mt-12">
                    <div>
                        <div class="text-4xl font-bold text-white mb-1" id="hero-efficiency">--%</div>
                        <div class="text-xs text-zinc-500 font-mono uppercase tracking-widest">Eficiencia Global</div>
                    </div>
                    <div>
                        <div class="text-4xl font-bold text-white mb-1 flex items-center gap-2">
                            <span id="hero-modules">--</span>
                            <span class="text-base text-zinc-600 font-normal">/ 5</span>
                        </div>
                        <div class="text-xs text-zinc-500 font-mono uppercase tracking-widest">Módulos Online</div>
                    </div>
                </div>
            </section>

            <!-- SECCIÓN 2: CARACTERÍSTICAS -->
            <section class="reveal space-y-8">
                <h2 class="text-3xl font-bold text-white mb-8 flex items-center gap-3">
                    <i class="ph-fill ph-cpu text-brand"></i>
                    Núcleo Operativo
                </h2>
                
                <!-- Feature Card 1 -->
                <div class="glass-panel p-8 rounded-2xl hover:border-brand/30 transition-colors group">
                    <div class="w-12 h-12 bg-white/5 rounded-lg flex items-center justify-center mb-4 group-hover:bg-brand/10 transition-colors">
                        <i class="ph-bold ph-chart-line-up text-2xl text-zinc-400 group-hover:text-brand"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-2">Finanzas en Tiempo Real</h3>
                    <p class="text-zinc-400 text-sm leading-relaxed">
                        Visualización instantánea de flujo de caja, nómina y gastos operativos. Sin retrasos, sin errores.
                    </p>
                </div>

                <!-- Feature Card 2 -->
                <div class="glass-panel p-8 rounded-2xl hover:border-brand/30 transition-colors group">
                    <div class="w-12 h-12 bg-white/5 rounded-lg flex items-center justify-center mb-4 group-hover:bg-brand/10 transition-colors">
                        <i class="ph-bold ph-shield-check text-2xl text-zinc-400 group-hover:text-brand"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-2">Seguridad Grado Militar</h3>
                    <p class="text-zinc-400 text-sm leading-relaxed">
                        Encriptación de extremo a extremo para todas las comunicaciones internas y datos sensibles.
                    </p>
                </div>
            </section>

            <!-- SECCIÓN 3: VISUALIZACIÓN DATA -->
            <section class="reveal">
                <div class="glass-panel rounded-3xl p-1 overflow-hidden relative">
                    <div class="absolute inset-0 bg-gradient-to-b from-brand/10 to-transparent opacity-20"></div>
                    <div class="bg-black/80 rounded-[20px] p-8 relative">
                        <div class="flex justify-between items-center mb-8">
                            <h3 class="font-bold text-white">Monitoreo de Red</h3>
                            <div class="flex gap-2">
                                <div class="w-2 h-2 rounded-full bg-red-500"></div>
                                <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                                <div class="w-2 h-2 rounded-full bg-green-500"></div>
                            </div>
                        </div>
                        <!-- Gráfica decorativa CSS -->
                        <div class="flex items-end justify-between h-40 gap-2">
                            <div class="w-full bg-zinc-800 rounded-t-sm h-[40%] hover:bg-brand transition-all duration-500"></div>
                            <div class="w-full bg-zinc-800 rounded-t-sm h-[70%] hover:bg-brand transition-all duration-500"></div>
                            <div class="w-full bg-zinc-800 rounded-t-sm h-[50%] hover:bg-brand transition-all duration-500"></div>
                            <div class="w-full bg-zinc-800 rounded-t-sm h-[90%] hover:bg-brand transition-all duration-500"></div>
                            <div class="w-full bg-zinc-800 rounded-t-sm h-[60%] hover:bg-brand transition-all duration-500"></div>
                            <div class="w-full bg-zinc-800 rounded-t-sm h-[80%] hover:bg-brand transition-all duration-500"></div>
                        </div>
                        <div class="mt-4 flex justify-between text-xs text-zinc-500 font-mono">
                            <span>00:00</span>
                            <span>12:00</span>
                            <span>24:00</span>
                        </div>
                    </div>
                </div>
            </section>

             <footer class="text-zinc-600 text-sm pt-20">
                &copy; 2025 God's Plan Enterprise System. Todos los derechos reservados.
            </footer>
        </div>

        <!-- COLUMNA DERECHA (STICKY LOGIN) -->
        <div class="lg:col-span-5 relative">
            <div class="sticky-container w-full">
                
                <!-- CARD LOGIN / REGISTER -->
                <div id="auth-panel" class="glass-panel rounded-3xl p-8 shadow-2xl shadow-black/50 transition-all duration-500">
                    <div class="text-center mb-8">
                        <h2 id="auth-title" class="text-2xl font-bold text-white">Bienvenido</h2>
                        <p id="auth-subtitle" class="text-zinc-400 text-sm mt-2">Ingresa tus credenciales para acceder</p>
                    </div>

                    <form id="auth-form" onsubmit="event.preventDefault(); window.authLogic.processEmailAuth();">
                         <div id="name-field" class="mb-4 hidden fade-in">
                            <label class="block text-xs font-bold text-zinc-500 uppercase mb-2">Nombre</label>
                            <input type="text" id="reg-name" class="input-modern w-full" placeholder="Tu nombre oficial">
                        </div>

                        <div class="mb-4">
                            <label class="block text-xs font-bold text-zinc-500 uppercase mb-2">Identificación</label>
                            <input type="text" id="email" class="input-modern w-full" placeholder="ID o Email corporativo">
                        </div>

                        <div class="mb-6">
                            <label class="block text-xs font-bold text-zinc-500 uppercase mb-2">Contraseña</label>
                            <input type="password" id="password" class="input-modern w-full" placeholder="••••••••">
                        </div>

                        <div id="error-message" class="text-xs text-red-400 bg-red-500/10 p-3 rounded-lg mb-4 hidden border border-red-500/20 text-center"></div>

                        <button type="submit" id="submit-btn" class="w-full bg-brand hover:bg-red-600 text-white font-bold py-3.5 rounded-xl transition-all shadow-[0_0_20px_rgba(231,0,0,0.3)] hover:shadow-[0_0_30px_rgba(231,0,0,0.5)] flex items-center justify-center gap-2">
                            <span>ACCEDER</span>
                            <i class="ph-bold ph-arrow-right"></i>
                        </button>
                    </form>

                    <div class="mt-6 space-y-3">
                         <div class="grid grid-cols-2 gap-3">
                            <button onclick="window.authLogic.loginGoogle()" class="bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl py-2.5 flex items-center justify-center transition-colors">
                                <i class="ph-bold ph-google-logo text-lg text-white"></i>
                            </button>
                            <button onclick="window.authLogic.loginGuest()" class="bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl py-2.5 flex items-center justify-center transition-colors group text-zinc-400 hover:text-white" title="Invitado">
                                <i class="ph-bold ph-ghost text-lg"></i>
                            </button>
                        </div>
                        
                        <div class="text-center pt-2">
                            <button onclick="window.authLogic.toggleMode()" class="text-xs text-zinc-500 hover:text-white transition-colors">
                                <span id="toggle-text">¿No tienes cuenta? Regístrate</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- DASHBOARD RÁPIDO (Se muestra al loguear, reemplaza al login) -->
                <div id="dashboard-panel" class="glass-panel rounded-3xl p-8 shadow-2xl shadow-black/50 hidden animate-float">
                    <div class="flex items-center gap-4 mb-8 border-b border-white/5 pb-6">
                        <div class="w-16 h-16 rounded-full bg-brand flex items-center justify-center text-white text-2xl font-bold shadow-lg shadow-brand/40">
                            <span id="user-initial">U</span>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-white leading-tight">Hola, <br><span id="user-name-large" class="text-brand">Usuario</span></h2>
                            <p class="text-xs text-zinc-400 mt-1">Sesión Segura Activa</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 gap-3">
                        <a href="/adherencia.html" class="flex items-center gap-4 p-4 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-brand/50 transition-all group">
                            <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center text-zinc-400 group-hover:text-brand transition-colors">
                                <i class="ph-duotone ph-clock text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-sm text-white">Adherencia</h4>
                                <p class="text-[10px] text-zinc-500">Gestión de tiempos</p>
                            </div>
                            <i class="ph-bold ph-caret-right ml-auto text-zinc-600 group-hover:text-white"></i>
                        </a>

                        <a href="/chat.html" class="flex items-center gap-4 p-4 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-brand/50 transition-all group">
                             <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center text-zinc-400 group-hover:text-brand transition-colors">
                                <i class="ph-duotone ph-chat-centered-text text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-sm text-white">Chat Seguro</h4>
                                <p class="text-[10px] text-zinc-500">Canales encriptados</p>
                            </div>
                            <i class="ph-bold ph-caret-right ml-auto text-zinc-600 group-hover:text-white"></i>
                        </a>

                        <a href="/finanzas.html" class="flex items-center gap-4 p-4 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-brand/50 transition-all group">
                             <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center text-zinc-400 group-hover:text-brand transition-colors">
                                <i class="ph-duotone ph-currency-dollar text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-sm text-white">Finanzas</h4>
                                <p class="text-[10px] text-zinc-500">Nómina y Gastos</p>
                            </div>
                            <i class="ph-bold ph-caret-right ml-auto text-zinc-600 group-hover:text-white"></i>
                        </a>
                        
                         <a href="/cuenta.html" class="flex items-center gap-4 p-4 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-brand/50 transition-all group">
                             <div class="w-10 h-10 rounded-lg bg-zinc-900 flex items-center justify-center text-zinc-400 group-hover:text-brand transition-colors">
                                <i class="ph-duotone ph-user-gear text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-sm text-white">Mi Cuenta</h4>
                                <p class="text-[10px] text-zinc-500">Ajustes personales</p>
                            </div>
                            <i class="ph-bold ph-caret-right ml-auto text-zinc-600 group-hover:text-white"></i>
                        </a>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <!-- LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, updateProfile, signInWithCustomToken, signInAnonymously, signOut, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Scroll Animation Logic
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

        // Firebase Config
        const fallbackConfig = { apiKey: "AIzaSyCrHBz94UtgiaYntHCYhC5jNa6auUI63vQ", authDomain: "god-s-plan-d737b.firebaseapp.com", projectId: "god-s-plan-d737b", storageBucket: "god-s-plan-d737b.firebasestorage.app", messagingSenderId: "458198314028", appId: "1:458198314028:web:d62b24cee2d19ee5b47589" };
        let firebaseConfig = fallbackConfig;
        try { 
            if (typeof __firebase_config !== 'undefined' && __firebase_config) { 
                const envConfig = typeof __firebase_config === 'string' ? JSON.parse(__firebase_config) : __firebase_config; 
                if (envConfig && envConfig.apiKey) firebaseConfig = envConfig; 
            } 
        } catch(e) {}

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        setPersistence(auth, browserLocalPersistence).catch(console.error);

        // UI Refs
        const els = {
            authPanel: document.getElementById('auth-panel'),
            dashPanel: document.getElementById('dashboard-panel'),
            authTitle: document.getElementById('auth-title'),
            authSub: document.getElementById('auth-subtitle'),
            submitBtn: document.getElementById('submit-btn'),
            toggleTxt: document.getElementById('toggle-text'),
            nameField: document.getElementById('name-field'),
            errorMsg: document.getElementById('error-message'),
            miniUserDisplay: document.getElementById('user-display-mini'),
            headerUserName: document.getElementById('header-user-name'),
            largeUserName: document.getElementById('user-name-large'),
            userInitial: document.getElementById('user-initial'),
            // Metrics
            heroEff: document.getElementById('hero-efficiency'),
            heroMods: document.getElementById('hero-modules')
        };

        // Auth Logic
        window.authLogic = {
            mode: 'login',
            toggleMode: function() {
                this.mode = this.mode === 'login' ? 'register' : 'login';
                const isReg = this.mode === 'register';
                els.authTitle.textContent = isReg ? 'Crear Cuenta' : 'Bienvenido';
                els.authSub.textContent = isReg ? 'Completa tus datos para registrarte' : 'Ingresa tus credenciales para acceder';
                els.submitBtn.innerHTML = isReg ? '<span>REGISTRARSE</span>' : '<span>ACCEDER</span> <i class="ph-bold ph-arrow-right"></i>';
                els.toggleTxt.textContent = isReg ? '¿Ya tienes cuenta? Inicia sesión' : '¿No tienes cuenta? Regístrate';
                els.nameField.classList.toggle('hidden', !isReg);
                els.errorMsg.classList.add('hidden');
            },
            showError: function(msg) {
                els.errorMsg.textContent = msg;
                els.errorMsg.classList.remove('hidden');
                els.submitBtn.disabled = false;
                els.submitBtn.classList.remove('opacity-50');
            },
            processEmailAuth: async function() {
                els.submitBtn.disabled = true;
                els.submitBtn.classList.add('opacity-50');
                els.errorMsg.classList.add('hidden');

                let email = document.getElementById('email').value.trim();
                const pass = document.getElementById('password').value;
                if (!email.includes('@')) email = `${email}@godsplan.site`;

                try {
                    if (this.mode === 'login') {
                        await signInWithEmailAndPassword(auth, email, pass);
                    } else {
                        const name = document.getElementById('reg-name').value;
                        const cred = await createUserWithEmailAndPassword(auth, email, pass);
                        if (name) await updateProfile(cred.user, { displayName: name });
                    }
                } catch (e) {
                    let msg = "Error de conexión";
                    if(e.code.includes('invalid') || e.code.includes('found')) msg = "Credenciales incorrectas";
                    this.showError(msg);
                }
            },
            loginGoogle: async () => { try { await signInWithPopup(auth, new GoogleAuthProvider()); } catch(e){ els.errorMsg.textContent=e.message; els.errorMsg.classList.remove('hidden'); } },
            loginGuest: async () => { try { await signInAnonymously(auth); } catch(e){ els.errorMsg.textContent=e.message; els.errorMsg.classList.remove('hidden'); } },
            logout: async () => { await signOut(auth); window.location.reload(); }
        };

        document.getElementById('logout-button-mini').onclick = window.authLogic.logout;

        // Init System
        async function init() {
            // Metrics
            if(!auth.currentUser) try { await signInAnonymously(auth); } catch(e){}
            const metricsRef = doc(db, 'artifacts', appId, 'public', 'data', 'system_metrics', 'dashboard_stats');
            onSnapshot(metricsRef, (s) => {
                const d = s.exists() ? s.data() : { efficiency: 98, modules: [1,2,3,4] };
                if(els.heroEff) els.heroEff.textContent = `${d.efficiency || 98}%`;
                if(els.heroMods) els.heroMods.textContent = (d.modules || []).length;
            });

            // Auth State
            const token = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
            if(token) try { await signInWithCustomToken(auth, token); } catch(e){}

            onAuthStateChanged(auth, (user) => {
                if(user && !user.isAnonymous) {
                    const name = user.displayName || user.email.split('@')[0];
                    els.headerUserName.textContent = name;
                    els.largeUserName.textContent = name;
                    els.userInitial.textContent = name.charAt(0).toUpperCase();
                    
                    els.miniUserDisplay.classList.remove('hidden');
                    els.authPanel.classList.add('hidden');
                    els.dashPanel.classList.remove('hidden');
                } else {
                    els.miniUserDisplay.classList.add('hidden');
                    els.authPanel.classList.remove('hidden');
                    els.dashPanel.classList.add('hidden');
                }
            });
        }
        init();
    </script>
</body>
</html>
